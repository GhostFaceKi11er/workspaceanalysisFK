# model_export
对m1进行空载和有载的工作区间分析

输入: urdf
输出： octomap::Octree的.bt文件, Newvisitpointcount的txt文件，场景预览的png文件

# 基本信息
通过随机采样关节角然后通过FK得到末端执行器位置，如果力矩不超限则添加到octomap::OcTree中。如果FK时新访问点的比例低于processRatio则结束FK，开始IK。

# 代码框架
用到的文件: 

Analyzer.h, Analyzer.cpp   #IK 
CtrlC.h, CtrlC.cpp.   #处理ctrl+c中断


# 功能
整体思路： M1机器人一共有18个活动的关节，躯干4个，左臂和右臂各7个，均为revolute关节。

FK： 每次循环对躯干4个和右臂上的7个进行随机采样得到一组关节角配置，将该组关节角配置设定到M1中，得到末端执行器的位置；然后在octomap::OcTree中去搜索之前是否已经将该点更新到OcTree中并且设置为占据状态；如果已经有则跳过，如果之前没有则判断力矩是否超限，如果没有超限添加到OcTree中。循环的结束条件： 经过10分钟的间隔没有新的点更新到OcTree中。

IK： 对指定空间中的点遍历，如果该点在OcTree中没有找到则进行逆运动学求解。设置两只手末端执行器的位置，然后再将离散化后的绕y轴的角度加到两只手的末端执行器上。如果有解且力矩不超限则更新到OcTree中。

可视化：对指定的空间（3维空间或2维平面）内的点进行离散化，分辨率大小为resolution和OcTree保持一致。然后对该指定空间内的点进行遍历，判断能否在OcTree中搜索到该点，如果有则将该点添加到pointcloud中，颜色设置为蓝色；对边界上的点也要离散化并添加到点云中，颜色设置为红色。
（另一种思路：对OcTree中的叶子节点进行遍历然后添加到pointcloud中，但会出现叶子节点被母节点代表的情况（和OcTree八叉数的结构有关），在可视化时就无法看到所有的有效点）


运行可执行文件后会生成两个文件，一个为保存有效点个数的NewvisitPointCount.txt文件，另一个为存储OcTree的M1_full.bt文件。

每遍历1000个空间中的点会自动保存数据到上述两个文件，同时提供了手动保存：按下Ctrl + c可以手动中断程序并保存数据到上述两个文件。

运行结束的时候会弹出osgViewer场景预览的图片

# 示例


